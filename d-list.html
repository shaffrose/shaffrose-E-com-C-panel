<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Saved Address Labels</title>
  <style>
    body {
      background-color: rgb(39, 39, 39);
      font-family: sans-serif;
      margin: 0;
      padding: 0;
    }
    header {
      padding: 10px 15px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: #000;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 10;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.5);
    }
    header img {
      height: 35px;
      width: auto;
    }
    header h1 {
      color: #FFDB58;
      font-size: 1.1rem;
      font-weight: 700;
      margin: 0;
      display: none;
      order: 1;
      width: 100%;
      text-align: center;
    }
    nav {
      display: none;
      flex-direction: column;
      gap: 15px;
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: rgba(0, 0, 0, 0.95);
      justify-content: center;
      align-items: center;
      z-index: 5;
    }
    nav.active {
      display: flex;
    }
    nav a {
      color: #fff;
      text-decoration: none;
      font-weight: 600;
      font-size: 1.2rem;
      margin: 10px 0;
      padding: 10px 20px;
    }
    nav a:hover {
      color: #FFDB58;
    }
    .hamburger {
      display: flex;
      flex-direction: column;
      gap: 5px;
      cursor: pointer;
      padding: 8px;
      margin-left: auto;
    }
    .hamburger div {
      width: 25px;
      height: 3px;
      background-color: #fff;
      border-radius: 5px;
      transition: all 0.3s ease;
    }
    .main {
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      padding: 15px;
      margin-top: 60px;
      margin-bottom: 60px;
      width: 100%;
      box-sizing: border-box;
    }
    #labels {
      padding: 10px;
      display: grid;
      gap: 10px;
      width: 100%;
      max-width: 800px;
      box-sizing: border-box;
    }
    .label {
      padding: 12px;
      background-color: white;
      border-radius: 5px;
      border: 1px solid #ddd;
      display: grid;
      gap: 8px;
      position: relative;
      font-size: 0.9rem;
    }
    .delete-btn {
      background-color: red;
      color: white;
      border: none;
      padding: 6px 12px;
      cursor: pointer;
      border-radius: 5px;
      font-size: 0.9rem;
      margin-top: 5px;
    }
    .date-badge {
  position: absolute;
  top: 5px;
  right: 5px;
  background-color: #FFDB58;
  color: #000;
  padding: 4px 10px;       /* Increased padding */
  border-radius: 10px;
  font-size: 0.9rem;        /* Increased font size */
  font-weight: bold;
}

    #noLabels {
      color: white;
      font-size: 1rem;
      text-align: center;
      padding: 20px;
    }
    footer {
      padding: 8px;
      width: 100%;
      background-color: #000;
      color: white;
      text-align: center;
      position: fixed;
      bottom: 0;
      left: 0;
      font-size: 0.7rem;
    }
    footer p {
      margin: 3px 0;
    }
    .search-container {
      width: 100%;
      max-width: 800px;
      margin-bottom: 15px;
      display: flex;
      gap: 8px;
      flex-direction: column;
    }
    .search-container input {
      flex: 1;
      padding: 10px;
      border-radius: 5px;
      border: none;
      font-size: 0.9rem;
    }
    .search-container button {
      padding: 10px;
      background-color: #FFDB58;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      font-weight: bold;
      font-size: 0.9rem;
    }
    .button-group {
      display: flex;
      gap: 8px;
      margin-bottom: 15px;
      flex-wrap: wrap;
      justify-content: center;
    }
    .button-group button {
      min-width: 120px;
      height: 40px;
      font-size: 0.9rem;
    }
    h1.page-title {
      color: #FFDB58;
      font-size: 1.2rem;
      font-weight: 700;
      text-align: center;
      margin: 10px 0 15px;
      width: 100%;
    }
    @media (min-width: 769px) {
      header h1 {
        display: none;
      }
      nav {
        display: flex;
        position: static;
        flex-direction: row;
        background-color: transparent;
        gap: 15px;
      }
      .hamburger {
        display: none;
      }
      .main {
        margin-top: 70px;
        margin-bottom: 70px;
      }
      .search-container {
        flex-direction: row;
      }
      h1.page-title {
        font-size: 1.5rem;
      }
    }
  </style>
</head>
<body>
  <header>
    <img src="./C-_Users_USER_Downloads_FI-LOGO.png" alt="Logo" />
    <h1>Saved Address Labels</h1>
    <div class="hamburger" onclick="toggleMenu()">
      <div></div>
      <div></div>
      <div></div>
    </div>
    <nav>
      <a href="home.html">Home</a>
      <a href="sorter.html">A-Sorter</a>
      <a href="saved_labels.html">Saved Labels</a>
      <a href="#contact">Contact</a>
      <a href="#" onclick="logout(event)">Logout</a>
    </nav>
  </header>

  <div class="main">
    <h1 class="page-title">SAVED ADDRESS LABEL</h1>

    <div class="button-group">
      <button onclick="window.print()" style="background-color: #FFDB58; margin-top: 5px; border-radius: 6px;">Print Labels</button>
      <button class="delete-btn" onclick="deleteAllLabels()">Delete All</button>
    </div>

    <div class="search-container">
      <input type="text" id="searchInput" placeholder="Search by mobile or pincode..." />
      <div style="display: flex; gap: 8px;">
        <button onclick="searchLabels()">Search</button>
        <button onclick="clearSearch()">Clear</button>
      </div>
    </div>

    <div id="labels"></div>
    <p id="noLabels">No saved labels found.</p>
  </div>

  <footer>
    <p>Copyright © 2025 Powered By SHAFFROSE ®</p>
    <p>Designed by Shahzad Edathingal</p>
  </footer>

  <script>
    function toggleMenu() {
      const nav = document.querySelector('nav');
      nav.classList.toggle('active');
    }

    function loadSavedLabels(searchTerm = '') {
      const savedLabels = JSON.parse(localStorage.getItem('d-list')) || [];
      const labelsDiv = document.getElementById('labels');
      const noLabelsMessage = document.getElementById('noLabels');

      const filteredLabels = searchTerm
        ? savedLabels.filter(label => {
            const html = label.html?.toLowerCase().replace(/\s+/g, '') || '';
            const search = searchTerm.toLowerCase().replace(/\s+/g, '');
            return html.includes(search);
          })
        : savedLabels;

      if (filteredLabels.length === 0) {
        noLabelsMessage.style.display = 'block';
        noLabelsMessage.textContent = searchTerm
          ? 'No matching labels found.'
          : 'No saved labels found.';
      } else {
        noLabelsMessage.style.display = 'none';
        labelsDiv.innerHTML = '';
        filteredLabels.forEach((label, index) => {
          const labelElement = document.createElement('div');
          labelElement.classList.add('label');
          const labelDate = label.date ? new Date(label.date).toLocaleDateString() : '';
          labelElement.innerHTML = `
            <div class="date-badge">${labelDate}</div>
            ${label.html}
            <button class="delete-btn" onclick="deleteLabel(${index})">Delete</button>
          `;
          labelsDiv.appendChild(labelElement);
        });
      }
    }

    function searchLabels() {
      const searchTerm = document.getElementById('searchInput').value.trim();
      loadSavedLabels(searchTerm);
    }

    function clearSearch() {
      document.getElementById('searchInput').value = '';
      loadSavedLabels();
    }

    function deleteLabel(index) {
      if (confirm('Are you sure you want to delete this label?')) {
        const savedLabels = JSON.parse(localStorage.getItem('d-list')) || [];
        savedLabels.splice(index, 1);
        localStorage.setItem('d-list', JSON.stringify(savedLabels));
        loadSavedLabels(document.getElementById('searchInput').value.trim());
      }
    }

    function deleteAllLabels() {
      if (confirm("Are you sure you want to delete ALL labels? This cannot be undone!")) {
        localStorage.removeItem('d-list');
        document.getElementById('labels').innerHTML = '';
        document.getElementById('noLabels').style.display = 'block';
        document.getElementById('noLabels').textContent = 'No saved labels found.';
      }
    }

    function logout(event) {
      event.preventDefault();
      localStorage.clear();
      window.location.replace("index.html");
    }

    window.onload = function () {
      loadSavedLabels();
      document.getElementById('searchInput').addEventListener('keyup', function (event) {
        if (event.key === 'Enter') {
          searchLabels();
        }
      });
    };
  </script>
</body>
</html>
